/**
 * Copyright (c) 2013 Snow Software Service, LLC. All rights reserved.
 * @author Joseph Snow <http://SnowSoftwareServices.com>
 **/
(function(c){c.fn.spriteAnim=function(d){return this.each(function(g,h){var f=c.extend({},d,{element:c(h)});h.spriteAnim=new SpriteAnim(f)})};var b=12;var a=10;this.SpriteAnim=function(f){var d=this;var e={autoStart:false,fps:b,repeatCount:-1,resetOnStart:false,resetOnStop:false,resetOnLastRepeat:false,element:null,elementId:null,autoSize:false,startPos:{x:0,y:0},frameSize:{w:0,h:0},nextFrameShift:{w:0,h:0},frameIdx:0,frameCount:0,repeatIdx:0,intervalId:0};c.extend(d,e,f);d.getDefaultProps=function(){return c.extend({},e)};d._init=function(){if(d.startFrameIdx==null){d.startFrameIdx=0}if(d.stopFrameIdx==null){d.stopFrameIdx=Math.max(d.frameCount-1,0)}if(d.fpsDelay==null||d.fpsDelay<a){if(d.fps==null){d.fps=b}d.fpsDelay=Math.max(1000/d.fps,a)}var g=d.getElement();if(g){if(d.url!=null){g.css("background-image","url("+d.url+")")}if(d.autoSize){if(d.startPos!=null){g.css("background-position",-d.startPos.x+"px "+-d.startPos.y+"px")}if(d.frameSize!=null){g.css("width",d.frameSize.w+"px");g.css("height",d.frameSize.h+"px")}}}if(true&&d.autoStart){d.start()}};d.getElement=function(){var g=d.element;if(d.elementId!=null){g=c(d.elementId)}return g};d.reset=function(){d.gotoFrame(d.startFrameIdx)};d.gotoFrame=function(g){g=Math.min(Math.max(g,d.startFrameIdx),d.stopFrameIdx);if(d.frameIdx!=g){d.frameIdx=g;d._updateCurrentFrame()}};d.start=function(){if(d.intervalId>0){return}if(d.resetOnStart){d.reset()}if(Math.abs(d.stopFrameIdx-d.startFrameIdx)>0){d.repeatIdx=0;if(d.frameIdx>=d.stopFrameIdx){d.frameIdx=d.startFrameIdx}d.intervalId=setInterval(d._gotoNextFrame,d.fpsDelay)}};d.stop=function(){d._stopInterval();if(d.resetOnStop){d.reset()}};d._stopInterval=function(){if(d.intervalId>0){clearInterval(d.intervalId);d.intervalId=0;return true}return false};d.show=function(){var g=d.getElement();if(g){g.show();if(d.autoPlay){}}};d.hide=function(){var g=d.getElement();if(g){d.stop();g.hide()}};d._gotoNextFrame=function(){var g=false;var h=d.frameIdx;if(!d.reversed){d.frameIdx++;if(d.frameIdx>d.stopFrameIdx){d.frameIdx=d.startFrameIdx;g=true}}else{d.frameIdx--;if(d.frameIdx<=d.startFrameIdx){d.frameIdx=d.stopFrameIdx;g=true}}if(g){d.repeatIdx++;if(d.repeatCount>=0&&d.repeatIdx>d.repeatCount){d._stopInterval();if(!d.resetOnLastRepeat){d.frameIdx=h}}}d._updateCurrentFrame()};d._updateCurrentFrame=function(){var h=d.getElement();if(h){var g=-d.startPos.x;var i=-d.startPos.y;g-=d.frameIdx*d.nextFrameShift.x;i-=d.frameIdx*d.nextFrameShift.y;h.css("background-position",g+"px "+i+"px")}};d._init();return d}})(jQuery);